import{r as g,j as e,s as w,f as v,P as C}from"./app-bb087a40.js";import{I as y}from"./InputLabel-83e42476.js";import{P as x}from"./PrimaryButton-4e7bcbe5.js";import{S as R}from"./SelectInput-80a2979b.js";import{A as G}from"./AuthenticatedLayout-34a881ed.js";import _ from"./CandidateScoreList-498a1b55.js";import"./transition-f1420beb.js";import"./TableComponent-de06d55f.js";function k(S,r="total"){if(S.length<1)return[];function d(o,s){return s==="total"?o.total:o.scores[s]}function p(o,s,m){const N=(m/(s-o+1)).toFixed(1);for(let a=o;a<=s;a++)n[a].rank=N}const n=[...S].sort((o,s)=>d(s,r)-d(o,r));let c=1,l=0,h=0,j=d(n[0],r);return n.forEach((o,s)=>{const m=d(o,r);h+=c,m===j&&s!==0?s===n.length-1&&p(l,s,h):(s-l>1?p(l,s-1,h-c):n[l].rank=l+1,l=s,h=c,j=m,s===n.length-1&&(n[s].rank=s+1)),c++}),n}function O({auth:S,pageant:r,maleCandidates:d=[],femaleCandidates:p=[],criterias:n}){const[c,l]=g.useState([]),[h,j]=g.useState([]),[o,s]=g.useState(n),[m,N]=g.useState([1]),a=["Candidate Name"];g.useEffect(()=>{l(k(p)),j(k(d)),s(n);const t=n.reduce((i,u)=>(i[u.round]||(i[u.round]={}),i[u.round][u.group]||(i[u.round][u.group]=[]),i[u.round][u.group].push(u.name),i),{});if(!t[r.current_round]){N([]);return}const f=Object.keys(t[r.current_round]),P=Math.max(...f.map(Number));N(Array.from({length:P},(i,u)=>u+1))},[r]);const b=t=>{l(k(p,t)),j(k(d,t))};return o.map(t=>{a.push(t.name+" ("+t.percentage+")")}),a.push("Total"),r.current_round==1&&(a.push("Deduction"),a.push("Overall")),a.push("Rank"),e.jsxs(G,{user:S.user,header:e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:[r.pageant," Scores"]}),children:[e.jsx(w,{title:"Pageant"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsx(v,{href:route("pageant.for-printing",r.id),children:e.jsx(x,{children:"Summary"})}),e.jsx(x,{onClick:t=>{confirm("Are you sure? Not irreversable")&&(alert("Success"),C.get(route("pageant.reset-scores",r.id)))},children:"Reset Score"}),r.status!="finished"&&e.jsx(v,{children:e.jsx(x,{children:"End Pageant"})})]}),e.jsxs("div",{className:"uppercase dark:text-white text-lg",children:["Current Round:"," ",r.current_round??"Not Yet Started"]}),e.jsxs("div",{className:"uppercase dark:text-white text-lg",children:["Current Group:"," ",r.current_group??"Not Yet Started"]}),e.jsxs("div",{className:"uppercase dark:text-white text-lg",children:["Total Rounds: ",r.rounds]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("form",{children:[e.jsx(y,{value:"Change Round"}),e.jsxs(R,{name:"round",onChange:t=>{C.put(route("pageant.change-round",{pageant:r.id,round:t.target.value}))},children:[e.jsx("option",{value:"",hidden:!0,children:"Select"}),e.jsx("option",{value:"0",children:"Round 0"}),r.pageant_rounds.map((t,f)=>e.jsx("option",{value:t.round,children:`Round ${t.round}`},"R"+f))]})]}),e.jsxs("form",{children:[e.jsx(y,{value:"Change Group"}),e.jsxs(R,{name:"group",onChange:t=>{C.put(route("pageant.change-group",{pageant:r.id,group:t.target.value}))},children:[e.jsx("option",{value:"",hidden:!0,children:"Select"}),e.jsx("option",{value:"0",children:"Group 0"}),m.map((t,f)=>e.jsx("option",{value:t,children:`Group ${t}`},"G"+f))]})]})]}),e.jsxs("form",{children:[e.jsx(y,{value:"Sort By"}),e.jsxs(R,{name:"criteria",defaultValue:"total",onChange:t=>{b(t.target.value)},children:[e.jsx("option",{value:"total",children:"Total Points"}),o.map(t=>e.jsx("option",{value:t.id,children:t.name},"criteria-"+t.id))]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx(v,{href:route("scoring.admin",r.id),children:e.jsx(x,{children:"Score Hidden Criteria"})}),e.jsx(v,{href:route("pageant.candidates.select",r.id),children:e.jsx(x,{children:"Select Round Candidate"})}),e.jsx(v,{href:route("pageant.deduct",r.id),children:e.jsx(x,{children:"Deduct Points"})})]}),e.jsx("hr",{className:"mt-4 mb-2"}),(r.type=="mr"||r.type=="mr&ms")&&e.jsx(_,{gender:"Male",candidates:h,headings:a,current_round:r.current_round}),(r.type=="ms"||r.type=="mr&ms")&&e.jsx(_,{gender:"Female",candidates:c,headings:a,current_round:r.current_round})]})})})})]})}export{O as default};
