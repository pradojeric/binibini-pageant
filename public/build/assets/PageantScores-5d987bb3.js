import{r as d,j as e,s as R,f as p,P as N}from"./app-1bfcb586.js";import{I as S}from"./InputLabel-81d1bc36.js";import{S as b}from"./SelectInput-47275ee6.js";import{A as P}from"./AuthenticatedLayout-25918691.js";import G from"./CandidateScoreList-82806a74.js";import{r as c}from"./index-35fe23a6.js";import"./transition-5f6c6279.js";import"./TableComponent-903c5d7a.js";import"./index.esm-74f9e387.js";function f(j,s="total"){if(!j.length)return[];const l=t=>s==="total"?t.total:t.scores[s],h=[...j].sort((t,a)=>l(a)-l(t)),o=new Map;h.forEach((t,a)=>{const i=l(t),x=a+1;o.has(i)||o.set(i,[]),o.get(i).push(x)});const g=new Map;for(let[t,a]of o.entries()){const i=a.reduce((x,v)=>x+v,0);g.set(t,(i/a.length).toFixed(1))}return h.map(t=>({...t,rank:g.get(l(t))}))}function T({auth:j,pageant:s,maleCandidates:l=[],femaleCandidates:h=[],criterias:o}){const[g,t]=d.useState([]),[a,i]=d.useState([]),[x,v]=d.useState(o),[C,y]=d.useState([1]),w=d.useMemo(()=>["Candidate Name",...o.map(r=>`${r.name} (${r.percentage})`),"Total",...s.current_round===1?["Deduction","Overall"]:[],"Rank"],[o,s.current_round]);d.useEffect(()=>{t(f(h)),i(f(l)),v(o);const r=o.reduce((u,n)=>(u[n.round]||(u[n.round]={}),u[n.round][n.group]||(u[n.round][n.group]=[]),u[n.round][n.group].push(n.name),u),{});if(!r[s.current_round]){y([]);return}const m=Object.keys(r[s.current_round]),_=Math.max(...m.map(Number));y(Array.from({length:_},(u,n)=>n+1))},[s]);const k=r=>{t(f(h,r)),i(f(l,r))};return e.jsxs(P,{user:j.user,header:e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:[s.pageant," Scores"]}),children:[e.jsx(R,{title:"Pageant"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsx(p,{href:route("pageant.for-printing",s.id),children:e.jsx(c.Button,{color:"yellow",className:"transition duration-300 ease-in-out hover:bg-yellow-600",children:"Summary"})}),e.jsx(c.Button,{onClick:r=>{confirm("Are you sure? Not irreversable")&&(alert("Success"),N.get(route("pageant.reset-scores",s.id)))},color:"blue",className:"transition duration-300 ease-in-out hover:bg-blue-600",children:"Reset Score"}),s.status!="finished"&&e.jsx(p,{children:e.jsx(c.Button,{color:"red",className:"transition duration-300 ease-in-out hover:bg-red-600",children:"End Pageant"})})]}),e.jsxs("div",{className:" dark:text-white text-lg",children:["Current Round:"," ",e.jsxs("span",{className:"text-2xl",children:[" ",s.current_round??"Not Yet Started"]})]}),e.jsxs("div",{className:" dark:text-white text-lg",children:["Current Group:"," ",e.jsx("span",{className:"text-2xl",children:s.current_group??"Not Yet Started"})]}),e.jsxs("div",{className:" dark:text-white text-lg",children:["Total Rounds:",e.jsxs("span",{className:"text-2xl",children:[" ",s.rounds]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("form",{className:"space-y-2",children:[e.jsx(S,{value:"Change Round"}),e.jsxs(b,{name:"round",onChange:r=>{N.put(route("pageant.change-round",{pageant:s.id,round:r.target.value}))},children:[e.jsx("option",{value:"",hidden:!0,children:"Select"}),e.jsx("option",{value:"0",children:"Not started"}),s.pageant_rounds.map((r,m)=>e.jsx("option",{value:r.round,children:`${r.round_name}`},"R"+m))]})]}),e.jsxs("form",{className:"space-y-2",children:[e.jsx(S,{value:"Change Group"}),e.jsxs(b,{name:"group",onChange:r=>{N.put(route("pageant.change-group",{pageant:s.id,group:r.target.value}))},children:[e.jsx("option",{value:"",hidden:!0,children:"Select"}),e.jsx("option",{value:"0",children:"Group 0"}),C.map((r,m)=>e.jsx("option",{value:r,children:`Group ${r}`},"G"+m))]})]})]}),e.jsxs("form",{children:[e.jsx(S,{value:"Sort By"}),e.jsxs(b,{name:"criteria",defaultValue:"total",onChange:r=>{k(r.target.value)},children:[e.jsx("option",{value:"total",children:"Total Points"}),x.map(r=>e.jsx("option",{value:r.id,children:r.name},"criteria-"+r.id))]})]})]}),e.jsxs("div",{className:"mt-4 space-x-2",children:[e.jsx(p,{href:route("scoring.admin",s.id),children:e.jsx(c.Button,{color:"green",className:"transition duration-300 ease-in-out hover:bg-green-600",children:"Score Hidden Criteria"})}),e.jsx(p,{href:route("pageant.candidates.select",s.id),children:e.jsx(c.Button,{color:"blue",className:"transition duration-300 ease-in-out hover:bg-blue-600",children:"Select Round Candidate"})}),e.jsx(p,{href:route("pageant.deduct",s.id),children:e.jsx(c.Button,{color:"red",className:"transition duration-300 ease-in-out hover:bg-red-600",children:"Deduct Points"})})]}),e.jsx("hr",{className:"mt-4 mb-2"}),["mr","ms"].map(r=>s.type.includes(r)&&e.jsx(G,{gender:r==="mr"?"Male":"Female",candidates:r==="mr"?a:g,headings:w,current_round:s.current_round},r))]})})})})]})}export{T as default};
