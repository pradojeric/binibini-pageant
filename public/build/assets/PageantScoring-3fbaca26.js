import{q as v,r as n,j as e,s as N}from"./app-891b08b4.js";import{A as w}from"./AuthenticatedLayout-a2a0a01f.js";import S from"./CandidateBox-6f586fa1.js";import{P as k}from"./PrimaryButton-907b3a68.js";/* empty css             */import"./transition-28db58fe.js";import"./ScoringInput-a8d624ae.js";import"./TextInput-8f4c106c.js";import"./InputLabel-4f785d7c.js";import"./index-8c46b72d.js";function q({auth:h,pageant:r,candidates:o}){const{data:i,setData:c,post:p}=v({scores:[]}),l=n.useMemo(()=>r.type?r.type==="mr&ms"?["mr","ms"]:[r.type]:[],[r.type]),f={mr:o.filter(s=>s.gender==="mr"),ms:o.filter(s=>s.gender==="ms")},j=n.useCallback((s,t,d)=>{const m={candidate_id:s,criteria_id:t,score:d},x=i.scores.findIndex(a=>a.candidate_id===s&&a.criteria_id===t),u=x===-1?[...i.scores,m]:i.scores.map((a,b)=>b===x?m:a);c("scores",u),console.log(u)},[i.scores,c]),g=()=>{let s=new Set;for(let t of i.scores)s.add(t.candidate_id);for(let t of o)if(!s.has(t.id))return!1;return!0},y=s=>{if(s.preventDefault(),!g()){alert("All candidates must be scored");return}p(route("scoring.admin.store",r.id),{onError:t=>{console.log(t)}})};return e.jsxs(w,{user:h.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:r.pageant}),children:[e.jsx(N,{title:"Pageant"}),e.jsx("div",{className:"py-12 bg-fixed bg-contain bg-center",style:{backgroundImage:`url(/storage/${r.background})`},children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6 dark:text-white",children:e.jsxs("form",{onSubmit:y,children:[e.jsx("div",{className:"flex justify-between mb-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"uppercase",children:["Rounds: ",r.current_round]}),e.jsxs("div",{className:"uppercase",children:["Pageant Type: ",r.type]})]})}),e.jsx("hr",{}),l.map((s,t)=>e.jsxs(n.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h2",{className:"uppercase font-bold text-lg tracking-wide",children:s==="mr"?"Mr Candidates":"Ms Candidates"}),e.jsx("div",{className:"grid grid-cols-4 gap-8 mt-4",children:f[s].map(d=>e.jsx(S,{candidate:d,criterias:r.criterias,onInputData:j},d.id))})]}),t===0&&l.length>1&&e.jsx("hr",{className:"my-4"})]},s)),e.jsx("div",{className:"mt-5 flex justify-end",children:e.jsx(k,{children:"Save"})})]})})})})})]})}export{q as default};
