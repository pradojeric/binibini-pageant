import{r as u,j as e,s as R,f as c,P as N}from"./app-0d49c6ba.js";import{I as S}from"./InputLabel-9180ec2f.js";import{S as b}from"./SelectInput-01726176.js";import{A as P}from"./AuthenticatedLayout-13a09545.js";import G from"./CandidateScoreList-c49def03.js";import{r as h}from"./index-da6b138f.js";import"./transition-e2bf0233.js";import"./TableComponent-53f63566.js";import"./index.esm-74f9e387.js";function f(j,s="total"){if(!j.length)return[];const d=t=>s==="total"?t.total:t.scores[s],x=[...j].sort((t,a)=>d(a)-d(t)),o=new Map;x.forEach((t,a)=>{const i=d(t),m=a+1;o.has(i)||o.set(i,[]),o.get(i).push(m)});const g=new Map;for(let[t,a]of o.entries()){const i=a.reduce((m,v)=>m+v,0);g.set(t,(i/a.length).toFixed(1))}return x.map(t=>({...t,rank:g.get(d(t))}))}function T({auth:j,pageant:s,maleCandidates:d=[],femaleCandidates:x=[],criterias:o}){const[g,t]=u.useState([]),[a,i]=u.useState([]),[m,v]=u.useState(o),[C,y]=u.useState([1]),w=u.useMemo(()=>["Candidate Name",...o.map(r=>`${r.name} (${r.percentage})`),"Total",...s.current_round===1?["Deduction","Overall"]:[],"Rank"],[o,s.current_round]);u.useEffect(()=>{t(f(x)),i(f(d)),v(o);const r=o.reduce((l,n)=>(l[n.round]||(l[n.round]={}),l[n.round][n.group]||(l[n.round][n.group]=[]),l[n.round][n.group].push(n.name),l),{});if(!r[s.current_round]){y([]);return}const p=Object.keys(r[s.current_round]),_=Math.max(...p.map(Number));y(Array.from({length:_},(l,n)=>n+1))},[s]);const k=r=>{t(f(x,r)),i(f(d,r))};return e.jsxs(P,{user:j.user,header:e.jsxs("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:[s.pageant," Scores"]}),children:[e.jsx(R,{title:"Pageant"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex space-x-2 justify-end",children:[e.jsx(c,{href:route("pageant.for-printing",s.id),children:e.jsx(h.Button,{color:"yellow",className:"transition duration-300 ease-in-out hover:bg-yellow-600",children:"Summary"})}),e.jsx(c,{href:route("pageant.candidates.select",s.id),children:e.jsx(h.Button,{onClick:r=>{confirm("Are you sure? Not irreversable")&&(alert("Success"),N.get(route("pageant.reset-scores",s.id)))},color:"blue",className:"transition duration-300 ease-in-out hover:bg-blue-600",children:"Reset Score"})}),s.status!="finished"&&e.jsx(c,{children:e.jsx(h.Button,{color:"red",className:"transition duration-300 ease-in-out hover:bg-red-600",children:"End Pageant"})})]}),e.jsxs("div",{className:" dark:text-white text-lg",children:["Current Round:"," ",e.jsxs("span",{className:"text-2xl",children:[" ",s.current_round??"Not Yet Started"]})]}),e.jsxs("div",{className:" dark:text-white text-lg",children:["Current Group:"," ",e.jsx("span",{className:"text-2xl",children:s.current_group??"Not Yet Started"})]}),e.jsxs("div",{className:" dark:text-white text-lg",children:["Total Rounds:",e.jsxs("span",{className:"text-2xl",children:[" ",s.rounds]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("form",{className:"space-y-2",children:[e.jsx(S,{value:"Change Round"}),e.jsxs(b,{name:"round",onChange:r=>{N.put(route("pageant.change-round",{pageant:s.id,round:r.target.value}))},children:[e.jsx("option",{value:"",hidden:!0,children:"Select"}),e.jsx("option",{value:"0",children:"Not started"}),s.pageant_rounds.map((r,p)=>e.jsx("option",{value:r.round,children:`${r.round_name}`},"R"+p))]})]}),e.jsxs("form",{className:"space-y-2",children:[e.jsx(S,{value:"Change Group"}),e.jsxs(b,{name:"group",onChange:r=>{N.put(route("pageant.change-group",{pageant:s.id,group:r.target.value}))},children:[e.jsx("option",{value:"",hidden:!0,children:"Select"}),e.jsx("option",{value:"0",children:"Group 0"}),C.map((r,p)=>e.jsx("option",{value:r,children:`Group ${r}`},"G"+p))]})]})]}),e.jsxs("form",{children:[e.jsx(S,{value:"Sort By"}),e.jsxs(b,{name:"criteria",defaultValue:"total",onChange:r=>{k(r.target.value)},children:[e.jsx("option",{value:"total",children:"Total Points"}),m.map(r=>e.jsx("option",{value:r.id,children:r.name},"criteria-"+r.id))]})]})]}),e.jsxs("div",{className:"mt-4 space-x-2",children:[e.jsx(c,{href:route("scoring.admin",s.id),children:e.jsx(h.Button,{color:"green",className:"transition duration-300 ease-in-out hover:bg-green-600",children:"Score Hidden Criteria"})}),e.jsx(c,{href:route("pageant.candidates.select",s.id),children:e.jsx(h.Button,{color:"blue",className:"transition duration-300 ease-in-out hover:bg-blue-600",children:"Select Round Candidate"})}),e.jsx(c,{href:route("pageant.deduct",s.id),children:e.jsx(h.Button,{color:"red",className:"transition duration-300 ease-in-out hover:bg-red-600",children:"Deduct Points"})})]}),e.jsx("hr",{className:"mt-4 mb-2"}),["mr","ms"].map(r=>s.type.includes(r)&&e.jsx(G,{gender:r==="mr"?"Male":"Female",candidates:r==="mr"?a:g,headings:w,current_round:s.current_round},r))]})})})})]})}export{T as default};
